local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local Workspace = game:GetService("Workspace")
local TeleportService = game:GetService("TeleportService")

local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

if PlayerGui:FindFirstChild("NekedGUI") then
	PlayerGui.NekedGUI:Destroy()
end

local gui = Instance.new("ScreenGui")
gui.Name = "NekedGUI"
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
gui.ResetOnSpawn = false
gui.IgnoreGuiInset = true
gui.Parent = PlayerGui

local main = Instance.new("Frame")
main.Size = UDim2.new(0, 350, 0, 450)
main.Position = UDim2.new(0.1, 0, 0.2, 0)
main.BackgroundColor3 = Color3.fromRGB(25, 0, 40)
main.BackgroundTransparency = 0.15
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true
main.Parent = gui

local UICorner = Instance.new("UICorner", main)
UICorner.CornerRadius = UDim.new(0, 12)

local UIStroke = Instance.new("UIStroke", main)
UIStroke.Color = Color3.fromRGB(180, 120, 255)
UIStroke.Thickness = 2
UIStroke.Transparency = 0.3

local titleBar = Instance.new("Frame", main)
titleBar.Size = UDim2.new(1, 0, 0, 30)
titleBar.BackgroundColor3 = Color3.fromRGB(60, 0, 120)
titleBar.BackgroundTransparency = 0.2
titleBar.BorderSizePixel = 0

local title = Instance.new("TextLabel", titleBar)
title.Text = "Neked Admin Panel"
title.Size = UDim2.new(1, 0, 1, 0)
title.BackgroundTransparency = 1
title.Font = Enum.Font.GothamBold
title.TextColor3 = Color3.new(1, 1, 1)
title.TextSize = 16
title.TextStrokeTransparency = 0.7

local tabsFrame = Instance.new("Frame", main)
tabsFrame.Size = UDim2.new(1, 0, 0, 40)
tabsFrame.Position = UDim2.new(0, 0, 0, 30)
tabsFrame.BackgroundTransparency = 1

local mainTabButton = Instance.new("TextButton", tabsFrame)
mainTabButton.Size = UDim2.new(0.33, 0, 1, 0)
mainTabButton.Position = UDim2.new(0, 0, 0, 0)
mainTabButton.BackgroundColor3 = Color3.fromRGB(80, 0, 150)
mainTabButton.BackgroundTransparency = 0.3
mainTabButton.Text = "Main"
mainTabButton.Font = Enum.Font.GothamBold
mainTabButton.TextColor3 = Color3.new(1, 1, 1)
mainTabButton.TextSize = 14
mainTabButton.AutoButtonColor = false

local statsTabButton = Instance.new("TextButton", tabsFrame)
statsTabButton.Size = UDim2.new(0.33, 0, 1, 0)
statsTabButton.Position = UDim2.new(0.33, 0, 0, 0)
statsTabButton.BackgroundColor3 = Color3.fromRGB(70, 0, 130)
statsTabButton.BackgroundTransparency = 0.3
statsTabButton.Text = "Stats"
statsTabButton.Font = Enum.Font.Gotham
statsTabButton.TextColor3 = Color3.new(1, 1, 1)
statsTabButton.TextSize = 14
statsTabButton.AutoButtonColor = false

local teleportTabButton = Instance.new("TextButton", tabsFrame)
teleportTabButton.Size = UDim2.new(0.34, 0, 1, 0)
teleportTabButton.Position = UDim2.new(0.66, 0, 0, 0)
teleportTabButton.BackgroundColor3 = Color3.fromRGB(70, 0, 130)
teleportTabButton.BackgroundTransparency = 0.3
teleportTabButton.Text = "Teleport"
teleportTabButton.Font = Enum.Font.Gotham
teleportTabButton.TextColor3 = Color3.new(1, 1, 1)
teleportTabButton.TextSize = 14
teleportTabButton.AutoButtonColor = false

local mainContent = Instance.new("Frame", main)
mainContent.Size = UDim2.new(1, -20, 1, -90)
mainContent.Position = UDim2.new(0, 10, 0, 80)
mainContent.BackgroundTransparency = 1
mainContent.Visible = true

local statsContent = Instance.new("Frame", main)
statsContent.Size = UDim2.new(1, -20, 1, -90)
statsContent.Position = UDim2.new(0, 10, 0, 80)
statsContent.BackgroundTransparency = 1
statsContent.Visible = false

local teleportContent = Instance.new("Frame", main)
teleportContent.Size = UDim2.new(1, -20, 1, -90)
teleportContent.Position = UDim2.new(0, 10, 0, 80)
teleportContent.BackgroundTransparency = 1
teleportContent.Visible = false

local statsScrolling = Instance.new("ScrollingFrame", statsContent)
statsScrolling.Size = UDim2.new(1, 0, 1, 0)
statsScrolling.BackgroundTransparency = 1
statsScrolling.BorderSizePixel = 0
statsScrolling.ScrollBarThickness = 6
statsScrolling.CanvasSize = UDim2.new(0, 0, 0, 0)

local function makeButton(parent, text, yPos)
	local btn = Instance.new("TextButton", parent)
	btn.Size = UDim2.new(1, 0, 0, 35)
	btn.Position = UDim2.new(0, 0, 0, yPos)
	btn.BackgroundColor3 = Color3.fromRGB(70, 0, 130)
	btn.BackgroundTransparency = 0.3
	btn.Text = text
	btn.Font = Enum.Font.Gotham
	btn.TextColor3 = Color3.new(1, 1, 1)
	btn.TextSize = 14
	btn.AutoButtonColor = false
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
	return btn
end

local espToggle = makeButton(mainContent, "ESP Roles: OFF", 10)
local giveToolButton = makeButton(mainContent, "Give Kill Tool", 55)
local killAllButton = makeButton(mainContent, "Kill All", 100)
local killNearButton = makeButton(mainContent, "Kill Near", 145)
local speedToggle = makeButton(mainContent, "SpeedBoost: OFF", 190)
local fpsBoostButton = makeButton(mainContent, "FPS Boost", 235)
local rejoinButton = makeButton(mainContent, "ReJoin", 280)

local tpHomeButton = makeButton(teleportContent, "TP in home", 10)
local tpStreetButton = makeButton(teleportContent, "TP in street", 55)

local espEnabled = false
local speedEnabled = false
local espConnections = {}
local speedConnection
local currentTab = "Main"

local function buttonEffect(button)
	local original = button.BackgroundColor3
	TweenService:Create(button, TweenInfo.new(0.1), {BackgroundColor3 = Color3.fromRGB(150, 0, 255)}):Play()
	task.wait(0.1)
	TweenService:Create(button, TweenInfo.new(0.2), {BackgroundColor3 = original}):Play()
end

local function switchTab(tabName)
	mainContent.Visible = false
	statsContent.Visible = false
	teleportContent.Visible = false
	
	mainTabButton.BackgroundColor3 = Color3.fromRGB(70, 0, 130)
	mainTabButton.Font = Enum.Font.Gotham
	statsTabButton.BackgroundColor3 = Color3.fromRGB(70, 0, 130)
	statsTabButton.Font = Enum.Font.Gotham
	teleportTabButton.BackgroundColor3 = Color3.fromRGB(70, 0, 130)
	teleportTabButton.Font = Enum.Font.Gotham
	
	if tabName == "Main" then
		mainContent.Visible = true
		mainTabButton.BackgroundColor3 = Color3.fromRGB(80, 0, 150)
		mainTabButton.Font = Enum.Font.GothamBold
	elseif tabName == "Stats" then
		statsContent.Visible = true
		statsTabButton.BackgroundColor3 = Color3.fromRGB(80, 0, 150)
		statsTabButton.Font = Enum.Font.GothamBold
	elseif tabName == "Teleport" then
		teleportContent.Visible = true
		teleportTabButton.BackgroundColor3 = Color3.fromRGB(80, 0, 150)
		teleportTabButton.Font = Enum.Font.GothamBold
	end
	currentTab = tabName
end

mainTabButton.MouseButton1Click:Connect(function()
	switchTab("Main")
end)

statsTabButton.MouseButton1Click:Connect(function()
	switchTab("Stats")
end)

teleportTabButton.MouseButton1Click:Connect(function()
	switchTab("Teleport")
end)

local function teleportToHome()
	local character = LocalPlayer.Character
	if character and character:FindFirstChild("HumanoidRootPart") then
		character.HumanoidRootPart.CFrame = CFrame.new(29.31, 5.27, 16.87)
	end
end

local function teleportToStreet()
	local character = LocalPlayer.Character
	if character and character:FindFirstChild("HumanoidRootPart") then
		character.HumanoidRootPart.CFrame = CFrame.new(-33.97, 3.81, 36.73)
	end
end

local function updateESP()
	if not espEnabled then return end
	
	for _, player in pairs(Players:GetPlayers()) do
		local character = player.Character
		if character and character:FindFirstChild("HumanoidRootPart") then
			local humanoidRootPart = character.HumanoidRootPart
			local esp = humanoidRootPart:FindFirstChild("ESP")
			
			if not esp then
				local billboard = Instance.new("BillboardGui")
				billboard.Name = "ESP"
				billboard.Adornee = humanoidRootPart
				billboard.Size = UDim2.new(0, 200, 0, 50)
				billboard.StudsOffset = Vector3.new(0, 3, 0)
				billboard.AlwaysOnTop = true
				billboard.Enabled = true
				
				local textLabel = Instance.new("TextLabel")
				textLabel.Size = UDim2.new(1, 0, 1, 0)
				textLabel.BackgroundTransparency = 1
				textLabel.Text = player.Name
				textLabel.TextScaled = true
				textLabel.Font = Enum.Font.GothamBold
				textLabel.TextStrokeTransparency = 0
				textLabel.TextStrokeColor3 = Color3.new(0, 0, 0)
				
				local roleValue = player:FindFirstChild("PlayerRole")
				if roleValue then
					if roleValue.Value == "Visitor" then
						textLabel.TextColor3 = Color3.new(1, 0, 0)
					elseif roleValue.Value == "Character" then
						textLabel.TextColor3 = Color3.new(0, 0, 1)
					elseif roleValue.Value == "Survivor" then
						textLabel.TextColor3 = Color3.new(0, 1, 0)
					else
						textLabel.TextColor3 = Color3.new(1, 1, 1)
					end
				else
					textLabel.TextColor3 = Color3.new(1, 1, 1)
				end
				
				textLabel.Parent = billboard
				billboard.Parent = humanoidRootPart
			else
				local textLabel = esp:FindFirstChildOfClass("TextLabel")
				if textLabel then
					local roleValue = player:FindFirstChild("PlayerRole")
					if roleValue then
						if roleValue.Value == "Visitor" then
							textLabel.TextColor3 = Color3.new(1, 0, 0)
						elseif roleValue.Value == "Character" then
							textLabel.TextColor3 = Color3.new(0, 0, 1)
						elseif roleValue.Value == "Survivor" then
							textLabel.TextColor3 = Color3.new(0, 1, 0)
						else
							textLabel.TextColor3 = Color3.new(1, 1, 1)
						end
					else
						textLabel.TextColor3 = Color3.new(1, 1, 1)
					end
				end
			end
		end
	end
end

local function enableESP()
	espEnabled = true
	espToggle.Text = "ESP Roles: ON"
	
	for _, player in pairs(Players:GetPlayers()) do
		local character = player.Character
		if character and character:FindFirstChild("HumanoidRootPart") then
			local esp = character.HumanoidRootPart:FindFirstChild("ESP")
			if esp then
				esp:Destroy()
			end
		end
	end
	
	espConnections.playerAdded = Players.PlayerAdded:Connect(function(player)
		task.wait(0.5)
		updateESP()
	end)
	
	espConnections.playerRemoving = Players.PlayerRemoving:Connect(function(player)
		local character = player.Character
		if character and character:FindFirstChild("HumanoidRootPart") then
			local esp = character.HumanoidRootPart:FindFirstChild("ESP")
			if esp then
				esp:Destroy()
			end
		end
	end)
	
	espConnections.updateLoop = RunService.Heartbeat:Connect(function()
		updateESP()
	end)
end

local function disableESP()
	espEnabled = false
	espToggle.Text = "ESP Roles: OFF"
	
	for _, connection in pairs(espConnections) do
		connection:Disconnect()
	end
	espConnections = {}
	
	for _, player in pairs(Players:GetPlayers()) do
		local character = player.Character
		if character and character:FindFirstChild("HumanoidRootPart") then
			local esp = character.HumanoidRootPart:FindFirstChild("ESP")
			if esp then
				esp:Destroy()
			end
		end
	end
end

local function giveKillTool()
	local tool = Instance.new("Tool")
	tool.Name = "KillTool"
	tool.ToolTip = "Kill Players"
	tool.CanBeDropped = false
	
	local handle = Instance.new("Part")
	handle.Name = "Handle"
	handle.Size = Vector3.new(0.1, 0.1, 0.1)
	handle.Transparency = 1
	handle.Parent = tool
	
	tool.Activated:Connect(function()
		local character = LocalPlayer.Character
		if character then
			local humanoidRootPart = character:FindFirstChild("HumanoidRootPart")
			if humanoidRootPart then
				local mouse = LocalPlayer:GetMouse()
				local target = mouse.Target
				if target then
					local humanoid = target.Parent:FindFirstChildOfClass("Humanoid")
					if humanoid then
						local player = Players:GetPlayerFromCharacter(target.Parent)
						if player then
							ReplicatedStorage.EventsFolder.KillVictim:FireServer(player.Name)
						end
					end
				end
			end
		end
	end)
	
	if LocalPlayer.Backpack then
		tool.Parent = LocalPlayer.Backpack
	end
end

local function killAllPlayers()
	for _, player in pairs(Players:GetPlayers()) do
		if player ~= LocalPlayer then
			ReplicatedStorage.EventsFolder.KillVictim:FireServer(player.Name)
		end
	end
end

local function killNearestPlayer()
	local character = LocalPlayer.Character
	if character and character:FindFirstChild("HumanoidRootPart") then
		local localPos = character.HumanoidRootPart.Position
		local nearestPlayer = nil
		local nearestDistance = math.huge
		
		for _, player in pairs(Players:GetPlayers()) do
			if player ~= LocalPlayer then
				local targetChar = player.Character
				if targetChar and targetChar:FindFirstChild("HumanoidRootPart") then
					local distance = (localPos - targetChar.HumanoidRootPart.Position).Magnitude
					if distance < nearestDistance then
						nearestDistance = distance
						nearestPlayer = player
					end
				end
			end
		end
		
		if nearestPlayer then
			ReplicatedStorage.EventsFolder.KillVictim:FireServer(nearestPlayer.Name)
		end
	end
end

local function enableSpeedBoost()
	speedEnabled = true
	speedToggle.Text = "SpeedBoost: ON"
	
	speedConnection = RunService.Heartbeat:Connect(function()
		local character = LocalPlayer.Character
		if character then
			local humanoid = character:FindFirstChildOfClass("Humanoid")
			if humanoid then
				humanoid.WalkSpeed = 50
			end
		end
	end)
end

local function disableSpeedBoost()
	speedEnabled = false
	speedToggle.Text = "SpeedBoost: OFF"
	
	if speedConnection then
		speedConnection:Disconnect()
		speedConnection = nil
	end
	
	local character = LocalPlayer.Character
	if character then
		local humanoid = character:FindFirstChildOfClass("Humanoid")
		if humanoid then
			humanoid.WalkSpeed = 16
		end
	end
end

local function boostFPS()
	for _, obj in pairs(Workspace:GetDescendants()) do
		if obj:IsA("Part") then
			obj.Material = Enum.Material.Plastic
			obj.Reflectance = 0
		elseif obj:IsA("Decal") then
			obj.Transparency = 1
		elseif obj:IsA("Texture") then
			obj.Transparency = 1
		end
	end
end

local function rejoinServer()
	TeleportService:Teleport(game.PlaceId, LocalPlayer)
end

local statsLabels = {}

local function updateStats()
	local yPos = 0
	local labelHeight = 25
	
	for _, label in pairs(statsLabels) do
		label:Destroy()
	end
	statsLabels = {}
	
	for _, player in pairs(Players:GetPlayers()) do
		local roleValue = player:FindFirstChild("PlayerRole")
		local roleText = ""
		local textColor = Color3.new(1, 1, 1)
		
		if roleValue and roleValue:IsA("StringValue") then
			roleText = player.Name .. " - " .. roleValue.Value
			if roleValue.Value == "Visitor" then
				textColor = Color3.new(1, 0, 0)
			elseif roleValue.Value == "Character" then
				textColor = Color3.new(0, 0, 1)
			elseif roleValue.Value == "Survivor" then
				textColor = Color3.new(0, 1, 0)
			end
		else
			roleText = player.Name .. " - No Role"
		end
		
		local label = Instance.new("TextLabel", statsScrolling)
		label.Size = UDim2.new(1, 0, 0, labelHeight)
		label.Position = UDim2.new(0, 0, 0, yPos)
		label.BackgroundTransparency = 1
		label.Text = roleText
		label.Font = Enum.Font.Gotham
		label.TextColor3 = textColor
		label.TextSize = 12
		label.TextXAlignment = Enum.TextXAlignment.Left
		
		table.insert(statsLabels, label)
		yPos = yPos + labelHeight
	end
	
	statsScrolling.CanvasSize = UDim2.new(0, 0, 0, yPos)
end

RunService.Heartbeat:Connect(function()
	if currentTab == "Stats" then
		updateStats()
	end
end)

espToggle.MouseButton1Click:Connect(function()
	buttonEffect(espToggle)
	if espEnabled then
		disableESP()
	else
		enableESP()
	end
end)

giveToolButton.MouseButton1Click:Connect(function()
	buttonEffect(giveToolButton)
	giveKillTool()
end)

killAllButton.MouseButton1Click:Connect(function()
	buttonEffect(killAllButton)
	killAllPlayers()
end)

killNearButton.MouseButton1Click:Connect(function()
	buttonEffect(killNearButton)
	killNearestPlayer()
end)

speedToggle.MouseButton1Click:Connect(function()
	buttonEffect(speedToggle)
	if speedEnabled then
		disableSpeedBoost()
	else
		enableSpeedBoost()
	end
end)

fpsBoostButton.MouseButton1Click:Connect(function()
	buttonEffect(fpsBoostButton)
	boostFPS()
end)

rejoinButton.MouseButton1Click:Connect(function()
	buttonEffect(rejoinButton)
	rejoinServer()
end)

tpHomeButton.MouseButton1Click:Connect(function()
	buttonEffect(tpHomeButton)
	teleportToHome()
end)

tpStreetButton.MouseButton1Click:Connect(function()
	buttonEffect(tpStreetButton)
	teleportToStreet()
end)

updateStats()
